<VirtualHost *:80>

    ServerName www.jvanalysis.com

    RewriteEngine On
    RewriteCond %{HTTP:X-Forwarded-Proto} =http
    RewriteRule . https://%{HTTP:Host}%{REQUEST_URI} [L,R=permanent]

    LogLevel info

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
    
    LoadModule wsgi_module "/home/ubuntu/.virtualenvs/jvanalysis/lib/python3.6/site-packages/mod_wsgi/server/mod_wsgi-py36.cpython-36m-x86_64-linux-gnu.so"
    WSGIScriptAlias / "/home/ubuntu/jvanalysis/jvanalysis.wsgi"
    WSGIDaemonProcess jvanalysis user=ubuntu group=ubuntu processes=2 threads=5 python-home="/home/ubuntu/.virtualenvs/jvanalysis" python-path="/home/ubuntu/.virtualenvs/jvanalysis/lib/python3.6/site-packages"

    <Directory /home/ubuntu/jvanalysis>
        WSGIProcessGroup jvanalysis
        WSGIApplicationGroup %{GLOBAL}
        Require all granted
    </Directory>

</VirtualHost>

<VirtualHost *:80>
    ServerName jvanalysis.com

    RewriteEngine On
    RewriteCond %{HTTP:X-Forwarded-Proto} =http
    RewriteRule . https://www.%{HTTP:Host}%{REQUEST_URI} [L,R=permanent]
</VirtualHost>
# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
